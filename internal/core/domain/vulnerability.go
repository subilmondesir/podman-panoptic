// internal/core/domain/vulnerability.go
package domain

// Severity représente la gravité d'une vulnérabilité
type Severity string

const (
	SeverityCritical Severity = "CRITICAL"
	SeverityHigh     Severity = "HIGH"
	SeverityMedium   Severity = "MEDIUM"
	SeverityLow      Severity = "LOW"
	SeverityInfo     Severity = "INFO"
)

// Vulnerability représente une faille de sécurité détectée
type Vulnerability struct {
	ID          string // CVE-2024-1234, GHSA-xxxx, etc.
	Severity    Severity
	Title       string
	Description string
	Package     string   // Package affecté
	Version     string   // Version vulnérable
	FixedIn     string   // Version corrigée (si disponible)
	References  []string // Liens externes (NVD, GitHub Advisory)
}

// Misconfiguration représente une mauvaise configuration de sécurité
type Misconfiguration struct {
	ID          string // PANOPTIC-001, CIS-4.1, etc.
	Severity    Severity
	Title       string
	Description string
	Resource    string // Conteneur, Image, Config file
	Remediation string // Comment corriger
}

// IsCritical vérifie si une vulnérabilité est critique
func (v Vulnerability) IsCritical() bool {
	return v.Severity == SeverityCritical || v.Severity == SeverityHigh
}
